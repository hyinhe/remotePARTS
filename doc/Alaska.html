<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Clay Morrow" />

<meta name="date" content="2022-06-29" />

<title>Alaska</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Alaska</h1>
<h3 class="subtitle">NDVI analysis {remotePARTS}</h3>
<h4 class="author">Clay Morrow</h4>
<h4 class="date">2022-06-29</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This vignette will demonstrate the main functionality of
<code>remotePARTS</code> by working through a real remote sensing data
set. The example follows the more-detailed development of the methods in
Ives et al.Â (2021, Remote Sensing of Environment, <a href="https://doi.org/10.1016/j.rse.2021.112678" class="uri">https://doi.org/10.1016/j.rse.2021.112678</a>).</p>
<p>First, install/update <code>remotePARTS</code> from github if
needed:</p>
<pre><code>devtools::install_github(&quot;morrowcj/remotePARTS&quot;)</code></pre>
<p>Then, ensure that the package is loaded into your library:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(remotePARTS)</span></code></pre></div>
<p>This vignette will use <code>dplyr</code> and <code>ggplot2</code>
for visualizing the data:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;dplyr&#39;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="do">## The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     filter, lag</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="do">## The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="do">##     intersect, setdiff, setequal, union</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
</div>
<div id="alaska-datasets" class="section level1">
<h1>Alaska datasets</h1>
<p><code>remotePARTS</code> ships with one spatial data object. This
dataset contains NDVI values derived from NASAâs MODIS satellite for the
US State of Alaska. The first object, <code>ndvi_AK10000</code>, due to
package size limitations, this dataset is a random sampling of 10,000
pixels from the full Alaska dataset. It is important to note, though
that <code>remotePARTS</code> can handle the full map (and much larger
maps).</p>
<p>For this vignette, we well also create a smaller 3000 pixel subsample
<code>ndvi_AK3000</code> for demonstrative purposes:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;ndvi_AK10000&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ndvi_AK3000 <span class="ot">&lt;-</span> ndvi_AK10000[<span class="fu">seq_len</span>(<span class="dv">3000</span>),] <span class="co"># first 3000 pixels from the random 10K</span></span></code></pre></div>
<p><code>ndvi_AK10000</code> is a <code>data.frame</code> with 37
columns. <code>lng</code> and <code>lat</code> are longitude and
latitude, respectively. <code>AR_coef</code> and <code>CLS_coef</code>
are pre-calculated coefficient estimates of the time trends in ndvi from
pixel-level time series analyses via AR REML and conditional least
squares, respectively. These coefficient estimates have been
standardized by the mean ndvi value for the pixel over that time period.
<code>land</code> is a factor representing land-cover classes, The
remaining 32 columns, of the form <code>ndviYYYY</code>, contain the
NDVI values from 1982 to 2013. These data sets already have rare land
classes, that occur in less than 2% of pixels, removed. Additionally,
both sets have no missing data. <code>remotePARTS</code> can
<strong>not</strong> handle any missing data. It is essential that
<strong>all</strong> missing data are removed prior to conducting any
analyses.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ndvi_AK10000)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    10000 obs. of  37 variables:</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ lng     : num  -151 -145 -144 -163 -145 ...</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ lat     : num  63.3 64.7 62.7 67.7 65.8 ...</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ AR_coef : num  0.01071 0.003586 0.002488 0.000373 0.002505 ...</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ CLS_coef: num  0.00529 0.001537 0.002276 0.000476 0.001514 ...</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ land    : Factor w/ 10 levels &quot;Evergr needle&quot;,..: 6 7 7 6 7 7 6 6 7 7 ...</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1982: num  1.88 7.68 8.46 6.85 10.25 ...</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1983: num  1.74 8.14 7.99 6.97 10.35 ...</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1984: num  1.96 8.47 8.04 6.67 10.29 ...</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1985: num  1.74 7.72 7.96 6.9 10.02 ...</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1986: num  1.92 8.31 8.64 6.43 10.39 ...</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1987: num  2.04 8.89 8.4 7 10.47 ...</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1988: num  2.13 8.5 8.32 7.12 10.05 ...</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1989: num  1.93 8.99 8.79 6.24 10.16 ...</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1990: num  1.73 8.66 8.45 7.46 10.31 ...</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1991: num  1.99 8.74 8.34 6.86 10.28 ...</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1992: num  1.74 7.99 7.94 6.53 9.77 ...</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1993: num  1.98 8.62 7.93 6.97 10.35 ...</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1994: num  2.04 8.59 8.26 7.15 10.25 ...</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1995: num  1.9 8.1 8.55 7.08 10.18 ...</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1996: num  2.09 8.61 8.23 7.08 10.33 ...</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1997: num  1.81 8.77 8.99 7.24 10.23 ...</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1998: num  1.95 7.9 8.57 7.45 9.99 ...</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi1999: num  1.75 8.14 8.61 6.75 10.04 ...</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2000: num  1.71 7.5 8.37 6.7 9.92 ...</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2001: num  1.57 7.76 8.29 6.66 9.69 ...</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2002: num  1.72 7.83 8.62 7.09 9.76 ...</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2003: num  1.95 7.94 8.35 6.87 9.76 ...</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2004: num  2.2 8.37 8.83 7.3 11.74 ...</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2005: num  2.18 8.45 8.63 7.18 11.62 ...</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2006: num  2.06 8.32 8.36 6.74 11.59 ...</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2007: num  2.39 8.53 8.63 7.47 11.91 ...</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2008: num  2.36 8.6 8.41 7 11.8 ...</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2009: num  2.35 10.02 9.27 6.59 11.62 ...</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2010: num  2.95 11.09 9.26 7.09 11.46 ...</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2011: num  2.5 8.9 8.94 7.05 12.15 ...</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2012: num  2.71 8.71 8.39 6.21 10.97 ...</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ndvi2013: num  2.54 9 8.95 6.93 10.38 ...</span></span></code></pre></div>
<p>For this demonstration, we are interested in asking the following
questions using these data: âIs NDVI in Alaska increasing over time?â;
âAre Alaskaâs NDVI time trends associated with land-cover classes?â; and
âDo Alaskaâs NDVI time trends differ with latitude?â</p>
<p>The figure below shows a temporal cross-section of these data for
1982, 1998, and 2013.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>reshape2<span class="sc">::</span><span class="fu">melt</span>(ndvi_AK10000, <span class="at">measure =</span> <span class="fu">c</span>(<span class="st">&quot;ndvi1982&quot;</span>, <span class="st">&quot;ndvi1998&quot;</span>, <span class="st">&quot;ndvi2013&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lng, <span class="at">y =</span> lat, <span class="at">col =</span> value )) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">col =</span> <span class="st">&quot;ndvi&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">&quot;ndvi&quot;</span>, <span class="st">&quot;&quot;</span>, variable), <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;magma&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The following figure shows how Alaskaâs three primary land-cover
classes are distributed.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ndvi_AK10000 <span class="sc">%&gt;%</span>  </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lng, <span class="at">y =</span> lat, <span class="at">col =</span> land)) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">end =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">col =</span> <span class="st">&quot;Land cover&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Land cover&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Use <code>help(&quot;ndvi_AK)</code> to see documentation for these
datasets.</p>
</div>
<div id="model" class="section level1">
<h1>Model</h1>
<p>When using <code>remotePARTS</code>, the data are assumed to follow
the general stochastic process of the form</p>
<p><span class="math display">\[y(t) = X(t)\beta +
\varepsilon(t)\]</span> where</p>
<ul>
<li><p><span class="math inline">\(y(t)\)</span> is a response variable
of interest at time <span class="math inline">\(t\)</span></p></li>
<li><p><span class="math inline">\(\beta\)</span> is a vector of
coefficients for the predictor variables <span class="math inline">\(X(t)\)</span> on <span class="math inline">\(y(t)\)</span></p></li>
<li><p><span class="math inline">\(\varepsilon(t)\)</span> is an
temporal autoregressive process: <span class="math inline">\(\varepsilon(t) = \rho \varepsilon(t - 1) +
\delta(t)\)</span></p></li>
<li><p>at any time step, <span class="math inline">\(\delta(t)\)</span>
is spatially autocorrelated according to covariance matrix <span class="math inline">\(\Sigma\)</span>: <span class="math inline">\(\delta(t) \sim N(0, \Sigma)\)</span></p></li>
<li><p>there is no temporal dependence in <span class="math inline">\(\delta(t)\)</span> (i.e., <span class="math inline">\(\delta(t_i)\)</span> is independent of <span class="math inline">\(\delta(t_j)\)</span> except when <span class="math inline">\(t_i\)</span> = <span class="math inline">\(t_j\)</span>)</p></li>
</ul>
</div>
<div id="time-series-analysis" class="section level1">
<h1>Time-series analysis</h1>
<p>The first step in a typical <code>remotePARTS</code> workflow is to
obtain pixel-level estimates of time-series coefficients. In our
example, we are interested in estimating the time trends in NDVI for
each pixel <span class="math inline">\(i\)</span>, represented by <span class="math inline">\(\beta_1\)</span> in the regression model</p>
<p><span class="math display">\[y_i(t) = \beta_0 + \beta_1 t +
\varepsilon_i(t)\]</span></p>
<p>where the random errors <span class="math inline">\(\varepsilon_i(t)\)</span> follow an AR(1)
process:</p>
<p><span class="math display">\[\varepsilon_i(t) = b\varepsilon_i(t - 1)
+ \delta_i(t)\]</span> <span class="math display">\[\delta_i(t) \sim N(0
, \sigma)\]</span></p>
<p>We will use <code>fitAR_map()</code> to estimate <span class="math inline">\(\beta_1\)</span>, which fits pixel-level AR(1)
models to a map of pixels and estimates coefficients using restricted
maximum likelihood (REML). To do so, we must extract only our NDVI
columns as the matrix <code>Y</code>. Weâll do this by matching all
column names containing ândviâ and slicing the data.frame:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ndvi.cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;ndvi&quot;</span>, <span class="fu">names</span>(ndvi_AK3000), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(ndvi_AK3000[, ndvi.cols])</span></code></pre></div>
<p>We also need a 2-column coordinate matrix <code>coords</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(ndvi_AK3000[, <span class="fu">c</span>(<span class="st">&quot;lng&quot;</span>, <span class="st">&quot;lat&quot;</span>)])</span></code></pre></div>
<p><code>Y</code> and <code>coords</code> are then passed to
<code>fitAR_map()</code> with default settings:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ARfit <span class="ot">&lt;-</span> <span class="fu">fitAR_map</span>(<span class="at">Y =</span> Y, <span class="at">coords =</span> coords)</span></code></pre></div>
<p>Coefficient estimates can be obtained from <code>ARfit</code> with
<code>coefficients()</code>. The first column is the estimate of <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\hat{\beta_0}\)</span>, and the second is <span class="math inline">\(\hat{\beta_1}\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">coefficients</span>(ARfit))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">##      (Intercept)            t</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]    1.703446  0.021923615</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]    7.980618  0.030464243</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]    8.146784  0.021130056</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,]    6.883592  0.002582853</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [5,]   10.081968  0.026466877</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [6,]    7.628119 -0.010395964</span></span></code></pre></div>
<p>These time-series analyses calculate the time trend in the raw NDVI
data. In most situations it makes sense to ask if there are time trends
in the relative NDVI values, that is, changes in NDVI relative to the
mean value of NDVI in a pixel. Scaling the trend in NDVI relative to the
mean gives assessments of the <strong>proportional</strong> change in
NDVI. These trends in the proportional NDVI are calculated be dividing
<span class="math inline">\(\hat{\beta_1}\)</span> by the mean. The
values of the trend coefficients are contained in
<code>ARfit$coefficients</code>, and since the coefficients for the
trend are in the column of the coefficients matrix named <code>t</code>,
the scaling is performed as</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ARfit<span class="sc">$</span>coefficients[, <span class="st">&quot;t&quot;</span>] <span class="ot">&lt;-</span> ARfit<span class="sc">$</span>coefficients[,<span class="st">&quot;t&quot;</span>]<span class="sc">/</span><span class="fu">rowMeans</span>(ndvi_AK3000[, ndvi.cols])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ndvi_AK3000<span class="sc">$</span>AR_coef <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(ARfit)[, <span class="st">&quot;t&quot;</span>] <span class="co"># save time trend coefficient</span></span></code></pre></div>
<p>These scaled values of the time trend are then stored in the
<code>ndvi_AK3000</code> data frame.</p>
<p>Below is an image of the estimated coefficients (pre-calculated and
scaled) for the full <code>ndvi_AK10000</code>. From this, it appears
that northern latitudes may be greening faster than more southern
latitudes.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ndvi_AK10000 <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lng, <span class="at">y =</span> lat, <span class="at">col =</span> AR_coef)) <span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient2</span>(<span class="at">high =</span> <span class="st">&quot;red&quot;</span>, <span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">col =</span> <span class="fu">expression</span>(beta[<span class="dv">1</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><code>fitAR_map</code> and its conditional least-squares counterpart,
<code>fitCLS_map</code>, are wrappers for the functions
<code>fitAR</code> and <code>fitCLS</code> which conduct individual time
series analysis. If the user wants, these can be applied on a
pixel-by-pixel basis to the data to allow greater flexibility. Both AR
REML and CLS methods account for temporal autocorrelation in the time
series. See function documentation for more details (i.e.,
<code>?fitAR_map()</code>).</p>
</div>
<div id="spatial-relationships" class="section level1">
<h1>Spatial relationships</h1>
<p>Now that weâve reduced the temporal component of each time series to
a single value (i.e., estimates of <span class="math inline">\(\beta_1\)</span>) while accounting for temporal
autocorrelation, we can focus on the spatial component of our
problem.</p>
<div id="distance" class="section level2">
<h2>Distance</h2>
<p>The first step is to calculate the distances among pixels as a
distance matrix <code>D</code>. Here, weâll calculate relative distances
with <code>distm_scaled()</code> from our coordinate matrix.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">distm_scaled</span>(coords)</span></code></pre></div>
<p><code>distm_scaled()</code> scales distances across the spatial
domain so that the greatest distance between two pixels is 1. Note that
because <code>distm_scaled()</code> uses
<code>geosphere::distm()</code>, it treats coordinates as degrees
longitude and latitude on a sphere and calculates distances
accordingly.</p>
</div>
<div id="covariance" class="section level2">
<h2>Covariance</h2>
<p>Next, we need to estimate the expected correlation between the random
errors of our spatial response variable (estimates of <span class="math inline">\(\beta_1\)</span>) based on their distances. To do
so, we need a spatial covariance function. In this example, we will use
an exponential covariance function to estimate correlations: <span class="math inline">\(V = \exp\big(\frac{-D}{r}\big)\)</span> where
<span class="math inline">\(r\)</span> is a parameter that dictates the
range of spatial autocorrelation. The function <code>covar_exp()</code>
corresponds to this covariance function.</p>
<p><code>V</code> represents the correlation among points if all
variation is accounted for. However, it is safest to assume that there
is some additional source of unexplained and unmeasured variance (a
nugget <span class="math inline">\(\eta\)</span>). Therefore, we assume
that the covariance structure among pixels is given by <span class="math inline">\(\Sigma = \eta I + (1-\eta)V\)</span> where <span class="math inline">\(I\)</span> is the identity matrix.</p>
<p>If we know the range parameter <span class="math inline">\(r\)</span>, we can calculate <code>V</code> from
<code>D</code> with <code>covar_exp()</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="fu">covar_exp</span>(D, r)</span></code></pre></div>
<p>And we could add a known nugget to <code>V</code> to obtain
<code>Sigma</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>nugget <span class="ot">&lt;-</span> <span class="fl">0.2</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">nrow</span>(V)) <span class="co"># identity matrix</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> nugget<span class="sc">*</span>I <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>nugget)<span class="sc">*</span>V</span></code></pre></div>
<p>See <code>?covar_exp()</code> for a description of the covariance
functions provided by <code>remotePARTS</code> and for more information
regarding their use.</p>
</div>
</div>
<div id="gls-3000-pixel-subset" class="section level1">
<h1>GLS: 3000-pixel subset</h1>
<p>To test spatial hypotheses with <code>remotePARTS</code>, we use a
generalized least-squares regression model (GLS):</p>
<p><span class="math display">\[\theta = X\alpha_{gls} + \gamma
\]</span> where</p>
<ul>
<li><p><span class="math inline">\(\theta\)</span> is a vector of
response values</p></li>
<li><p><span class="math inline">\(\alpha_{gls}\)</span> is a vector of
the effects of predictor variables <span class="math inline">\(X\)</span> on <span class="math inline">\(\theta\)</span></p></li>
<li><p>the error term <span class="math inline">\(\gamma\)</span> is
spatially autocorrelated according to <span class="math inline">\(\Sigma_\gamma\)</span>: <span class="math inline">\(\gamma \sim N(0, \Sigma_\gamma)\)</span></p></li>
</ul>
<p><span class="math inline">\(\theta\)</span> will usually be a
regression parameter. For example, if weâre interested in understanding
trends in NDVI over time, we would use the pixel-level regression
coefficient for the effect of time on NDVI (i.e., <span class="math inline">\(\theta = \hat\beta\)</span>)</p>
<div id="known-parameters" class="section level2">
<h2>Known parameters</h2>
<p>If the parameters that govern the spatial autocorrelation <span class="math inline">\(\Sigma_\gamma\)</span> are known, a GLS can be fit
with <code>fitGLS()</code>. Here, we will fit the GLS by providing (i) a
model formula, (ii) a data source, (iii) our <code>V</code> matrix,
which was pre-calculated with a spatial parameter <span class="math inline">\(r = 0.1\)</span> and (iv) a nugget of <span class="math inline">\(\eta = 0.2\)</span>.</p>
<p>The specific task in this examples is to estimate the effect of
land-cover class on our time trend. Because <code>land</code> is a
factor, weâll also specify a no-intercept model.</p>
<p>Note that the GLS fitting process requires an inversion of
<code>V</code>. This means that even with only the 3000-pixel subset, it
will take a few minutes to finish the computations on most
computers.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>GLS<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">fitGLS</span>(<span class="at">formula =</span> AR_coef <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> land, <span class="at">data =</span> ndvi_AK3000, <span class="at">V =</span> V, <span class="at">nugget =</span> nugget)</span></code></pre></div>
<p>Note also that <code>fitGLS</code> adds the nugget to <code>V</code>
internally. If we wanted to do this ourselves, we could pass the
covariance matrix <code>Sigma</code> which already contains a nugget
component and then set the <code>nugget</code> argument of
<code>fitGLS</code> to 0:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitGLS</span>(<span class="at">formula =</span> AR_coef <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> land, <span class="at">data =</span> ndvi_AK3000, <span class="at">V =</span> Sigma, <span class="at">nugget =</span> <span class="dv">0</span>) <span class="co"># equivalent</span></span></code></pre></div>
<p>The estimates for our land class effects can be extracted with
<code>coefficients()</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(GLS<span class="fl">.0</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="do">## landShrubland   landSavanna landGrassland </span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.0008646565  0.0002554862  0.0011294576</span></span></code></pre></div>
<p>The full model fit is given by</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>GLS<span class="fl">.0</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="do">## fitGLS(formula = AR_coef ~ 0 + land, data = ndvi_AK3000, V = V, </span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     nugget = nugget)</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="do">## t-tests:</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                     Est t.stat pval.t</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="do">## landShrubland 0.0008647 0.5065 0.6126</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="do">## landSavanna   0.0002555 0.1493 0.8813</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="do">## landGrassland 0.0011295 0.6648 0.5062</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="do">## F-test:</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="do">##                model df_F    SSE       MSE logLik Fstat  pval_F</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 AR_coef ~ 0 + land    2 0.1128 3.764e-05  12808 4.461 0.01163</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 2        AR_coef ~ 1 2997 0.1131 3.775e-05  12802    NA      NA</span></span></code></pre></div>
<p>Note that, although none of the three land-cover classes shows a
statistically significant time trend in (proportional) NDVI, the F-test
shows that there is a statistically significant difference among
land-cover classes, because the model including land-cover classes gives
a statistically significantly better fit to the data than the
intercept-only model.</p>
</div>
<div id="parameter-estimation" class="section level2">
<h2>Parameter estimation</h2>
<p>In practice, we rarely know the values of the parameters that govern
spatial autocorrelation (e.g., the range and nugget) in advance.
Therefore, these parameters will need to be estimated for most data.</p>
<div id="spatial-parameters" class="section level3">
<h3>Spatial parameters</h3>
<p>The spatial parameters of a covariance function (e.g.,
<code>covar_exp</code>) can be estimated from residuals of pixel-level
time-series models (see Ives et al.Â RSE, 2021). Although we conducted
the time-series analyses as though each pixel was independent (with
<code>fitAR_map()</code>), they are, in fact, dependent. Specifically,
the correlation of the residuals from the pixel-level analyses is
roughly proportional to the spatial autocorrelation of the residuals of
the spatial model, <span class="math inline">\(\gamma\)</span>, if all
of the variation in <span class="math inline">\(\gamma\)</span> is due
to the spatiotemporal variation produced by <span class="math inline">\(\varepsilon_i(t)\)</span>. Therefore, we can
estimate the range parameter for <strong>V</strong> as <span class="math inline">\(V_{ij} \approx \text{cor}\big(\varepsilon_i(t),
\varepsilon_j(t)\big)\)</span></p>
<p>The function <code>fitCor()</code> performs the estimation of spatial
parameters. We will pass to this function (i) the time-series residuals
for our map, extracted from the time-series analysis output object with
<code>residuals()</code>, (ii) the coordinate matrix
<code>coords</code>, (iii) the covariance function
<code>covar_exp()</code>, and (iv) a list specifying that we should
start the search for the optimal range parameter at 0.1. For this
example, we will also specify <code>fit.n = 3000</code>, which ensures
that all pixels are used to estimate spatial parameters.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>corfit <span class="ot">&lt;-</span> <span class="fu">fitCor</span>(<span class="at">resids =</span> <span class="fu">residuals</span>(ARfit), <span class="at">coords =</span> coords, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">covar_FUN =</span> <span class="st">&quot;covar_exp&quot;</span>, <span class="at">start =</span> <span class="fu">list</span>(<span class="at">range =</span> <span class="fl">0.1</span>), </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">fit.n =</span> <span class="dv">3000</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>(<span class="at">range.opt =</span> corfit<span class="sc">$</span>spcor)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     range </span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.1083729</span></span></code></pre></div>
<p>By default, <code>fitCor()</code> uses <code>distm_scaled()</code> to
calculate distances from the coordinate matrix, but any function that
returns a distance matrix can be specified with the
<code>distm_FUN</code> argument. It is important to scale the parameter
values appropriately, accounting for your distances. For example, if we
instead use <code>distm_km()</code> to calculate distance in km instead
of relative distances, we would need to scale our starting range
parameter by the maximum distance in km of our map:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>max.dist <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">distm_km</span>(coords))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>corfit.km <span class="ot">&lt;-</span> <span class="fu">fitCor</span>(<span class="at">resids =</span> <span class="fu">residuals</span>(ARfit), <span class="at">coords =</span> coords, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">covar_FUN =</span> <span class="st">&quot;covar_exp&quot;</span>, <span class="at">start =</span> <span class="fu">list</span>(<span class="at">range =</span> max.dist<span class="sc">*</span><span class="fl">0.1</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">distm_FUN =</span> <span class="st">&quot;distm_km&quot;</span>, <span class="at">fit.n =</span> <span class="dv">3000</span>)</span></code></pre></div>
<p>Note that, depending on the covariance function used, not all
parameters will need scaling. For example, <code>covar_exppow()</code>
is an exponential-power covariance function and takes a range and shape
parameter, but only the range parameter should scale with distance. See
<code>?fitCor()</code> for more details.</p>
<p>After weâve obtained our range parameter estimate, we can use it to
re-calculate the <code>V</code> matrix:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>V.opt <span class="ot">&lt;-</span> <span class="fu">covar_exp</span>(D, range.opt)</span></code></pre></div>
</div>
<div id="nugget" class="section level3">
<h3>Nugget</h3>
<p>Similar to finding the optimal spatial parameters, the nugget can be
estimated by selecting a nugget that maximizes the likelihood of the GLS
given the data. <code>fitGLS()</code> will find this maximum-likelihood
nugget when <code>nugget = NA</code> is specified. Note that this type
of optimization requires fitting multiple GLS models, which means it
will be much slower than our call to <code>fitGLS()</code> with a known
nugget.</p>
<p>In addition to our original arguments, weâll also explicitly set
<code>no.F = FALSE</code> so that F-tests are calculated. For the
F-tests, the default reduced model is the intercept-only model, although
it is also possible to specify alternative reduced models as a formula
in the <code>formula0</code> option.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>GLS.opt <span class="ot">&lt;-</span> <span class="fu">fitGLS</span>(<span class="at">formula =</span> AR_coef <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> land, <span class="at">data =</span> ndvi_AK3000, <span class="at">V =</span> V.opt, <span class="at">nugget =</span> <span class="cn">NA</span>, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">no.F =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">nug.opt =</span> GLS.opt<span class="sc">$</span>nugget)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1342314</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(GLS.opt)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="do">## landShrubland   landSavanna landGrassland </span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.0009201230  0.0003899361  0.0011467324</span></span></code></pre></div>
<p>Letâs compare our GLS from earlier with this one with optimized
parameters:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="at">GLS.0 =</span> <span class="fu">c</span>(<span class="at">range =</span> r, <span class="at">nugget =</span> GLS<span class="fl">.0</span><span class="sc">$</span>nugget, <span class="at">logLik =</span> GLS<span class="fl">.0</span><span class="sc">$</span>logLik, <span class="at">MSE =</span> GLS<span class="fl">.0</span><span class="sc">$</span>MSE),</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">GLS.opt =</span> <span class="fu">c</span>(<span class="at">range =</span> range.opt, <span class="at">nugget =</span> GLS.opt<span class="sc">$</span>nugget, <span class="at">logLik =</span> GLS.opt<span class="sc">$</span>logLik, <span class="at">MSE =</span> GLS.opt<span class="sc">$</span>MSE))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="do">##             range    nugget   logLik          MSE</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="do">## GLS.0   0.1000000 0.2000000 12807.91 3.763878e-05</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="do">## GLS.opt 0.1083729 0.1342314 12809.46 5.003165e-05</span></span></code></pre></div>
<p>Note that in this example, <code>logLik</code> for
<code>GLS.opt</code> is not functionally different than
<code>logLik</code> for <code>GLS.0</code>. This indicates that using
the values of <code>range</code> = 0.1 and <code>nugget</code> = 0.2
gives a similar likelihood than the optimal model when
<code>range</code> is constrained to be the value calculated from
<code>covar_exp()</code>, <code>GLS.opt</code>.</p>
</div>
<div id="simultaneous-parameter-estimation" class="section level3">
<h3>Simultaneous parameter estimation</h3>
<p>It is also possible to simultaneously estimate spatial parameters and
the nugget without using the time-series residuals. This is done by
finding the set of parameters describing spatial autocorrelation (e.g.,
<code>range</code> and <code>nugget</code>) that maximizes the
likelihood of a GLS given the data. This task is computationally slower
than optimizing <code>nugget</code> alone with <code>fitGLS()</code> and
therefore will take some time to run.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fitopt <span class="ot">&lt;-</span> <span class="fu">fitGLS_opt</span>(<span class="at">formula =</span> AR_coef <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> land, <span class="at">data =</span> ndvi_AK3000, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> ndvi_AK3000[, <span class="fu">c</span>(<span class="st">&quot;lng&quot;</span>, <span class="st">&quot;lat&quot;</span>)], </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">covar_FUN =</span> <span class="st">&quot;covar_exp&quot;</span>, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">start =</span> <span class="fu">c</span>(<span class="at">range =</span> .<span class="dv">1</span>, <span class="at">nugget =</span> .<span class="dv">2</span>))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>fitopt<span class="sc">$</span>opt<span class="sc">$</span>par</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="do">##      range     nugget </span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.03660171 0.26859993 </span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>fitopt<span class="sc">$</span>GLS<span class="sc">$</span>logLik</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 13276.15</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>fitopt<span class="sc">$</span>GLS<span class="sc">$</span>MSE</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.720775e-05</span></span></code></pre></div>
<p>Note that, because <code>fitGLS_opt()</code> does not require time
series residuals, it is possible to use <code>fitGLS_opt()</code> for
statistical problems involving only spatial variables. In other words,
rather than <span class="math inline">\(\theta\)</span> being a limited
to a time trend, it can be a purely spatial variable as well.</p>
<p>When time-series residuals are available, we recommend that you
estimate spatial parameters with <code>fitCor()</code> and
<code>fitGLS()</code>, rather than <code>fitGLS_opt()</code>. In
simulation studies, using <code>fitCor()</code> with
<code>fitGLS()</code> often has better statistical performance than
using <code>fitGLS_opt()</code>. See <code>?fitGLS_opt()</code> for more
information about this function and its use.</p>
</div>
</div>
</div>
<div id="hypothesis-testing" class="section level1">
<h1>Hypothesis testing</h1>
<p>The purpose of the tools provided by <code>remotePARTS</code> is to
test map-level hypotheses about spatiotemporal data sets. In this
example, we will test 3 hypotheses using 3 different GLS models. Note
that these hypothesis are framed as regression-style problems; indeed,
<code>fitGLS()</code> is essentially regression with spatially
autocorrelated random errors.</p>
<div id="intercept-only-model" class="section level2">
<h2>Intercept-only model</h2>
<p>If we want to test the hypothesis that âthere was a trend in Alaska
NDVI Alaska from 1982-2013â, we can regress the AR coefficient on an
intercept-only GLS model:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(GLS.int <span class="ot">&lt;-</span> <span class="fu">fitGLS</span>(AR_coef <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> ndvi_AK3000, <span class="at">V =</span> V.opt, <span class="at">nugget =</span> nug.opt, <span class="at">no.F =</span> <span class="cn">TRUE</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="do">## fitGLS(formula = AR_coef ~ 1, data = ndvi_AK3000, V = V.opt, </span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     nugget = nug.opt, no.F = TRUE)</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="do">## t-tests:</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                  Est t.stat pval.t</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 0.000972 0.4564 0.6481</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Model statistics:</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="do">##      SSE       MSE logLik</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 0.1503 5.011e-05  12806</span></span></code></pre></div>
<p>We can see from the t-test that the intercept is not statistically
different from zero. In other words, there is no map-level temporal
trend in NDVI across the entire data set. We have not performed an
F-test, because the full model is the intercept-only model and is
therefore the same as the reduced model.</p>
</div>
<div id="land-cover-effects" class="section level2">
<h2>Land-cover effects</h2>
<p>If we want to test the hypothesis that âtrends in Alaskan NDVI differ
by land- cover classâ, we can use <code>GLS.opt()</code> from
earlier:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>GLS.opt</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="do">## fitGLS(formula = AR_coef ~ 0 + land, data = ndvi_AK3000, V = V.opt, </span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     nugget = NA, no.F = FALSE)</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="do">## t-tests:</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                     Est t.stat pval.t</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="do">## landShrubland 0.0009201 0.4306 0.6668</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="do">## landSavanna   0.0003899 0.1822 0.8554</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="do">## landGrassland 0.0011467 0.5385 0.5903</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="do">## F-test:</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="do">##                model df_F    SSE       MSE logLik Fstat  pval_F</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 AR_coef ~ 0 + land    2 0.1499 5.003e-05  12809 3.263 0.03841</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 2        AR_coef ~ 1 2997 0.1503 5.014e-05  12805    NA      NA</span></span></code></pre></div>
<p>The t-tests show that the trend in NDVI, for all land-cover classes,
was not statistically different from zero, meaning that NDVI did not
show a statistically significant trend in any land-cover class. The
F-test (ANOVA table), however, shows that time trends in NDVI differ
among the land-cover classes. The better fit of the model with
land-cover classes can also be seen in the increase in the likelihood
(<code>logLik</code>) compared to the intercept-only model.</p>
</div>
<div id="latitude-effects" class="section level2">
<h2>Latitude effects</h2>
<p>Finally, to test the hypothesis that âtemporal trends in NDVI differ
with latitudeâ, we can regress the AR coefficient on latitude in our GLS
model:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(GLS.lat <span class="ot">&lt;-</span> <span class="fu">fitGLS</span>(AR_coef <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> lat, <span class="at">data =</span> ndvi_AK3000, <span class="at">V =</span> V.opt, <span class="at">nugget =</span> nug.opt,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">no.F =</span> <span class="cn">FALSE</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="do">## fitGLS(formula = AR_coef ~ 1 + lat, data = ndvi_AK3000, V = V.opt, </span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     nugget = nug.opt, no.F = FALSE)</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="do">## t-tests:</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                    Est   t.stat pval.t</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) -8.617e-04 -0.04362 0.9652</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="do">## lat          2.986e-05  0.09337 0.9256</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="do">## F-test:</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="do">##               model df_F    SSE       MSE logLik    Fstat pval_F</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 AR_coef ~ 1 + lat    1 0.1503 5.012e-05  12806 0.008719 0.9256</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 2       AR_coef ~ 1 2998 0.1503 5.012e-05  12806       NA     NA</span></span></code></pre></div>
<p>The t-tests show that temporal trends in NDVI did not differ with
latitude. Note that the p-value from the F-test is equivalent to that of
the t-test p-value for effect of latitude.</p>
</div>
<div id="conclusions-ndvi_ak3000" class="section level2">
<h2>Conclusions (ndvi_AK3000)</h2>
<p>We can see from these hypothesis tests that, at least among the
3000-pixel sub-sample of Alaska, the answer to all three questions that
we posed is no: there is no statistical evidence for an overall greening
in Alaska, nor differences among land-cover classes or latitude.</p>
</div>
</div>
<div id="gls-full-dataset" class="section level1">
<h1>GLS: Full dataset</h1>
<p>Until now, we have limited our analyses to the 3000-pixel subset of
Alaska, <code>ndvi_AK3000</code>. Calls to <code>fitGLS()</code> involve
inverting <code>V</code>, and the computational complexity scales with
<span class="math inline">\(N^3\)</span> where <span class="math inline">\(N\)</span> is the number of pixels in the map. We
have used the data set <code>ndvi_AK3000</code> up to now because the
computation time for the analyses is reasonable. However, 3000 pixels
means dealing with distance and covariance matrices that each contain
<span class="math inline">\(3,000 \times 3,000 = 9,000,000\)</span>
elements. This is approaching the upper size limit for obtaining
relatively fast results.</p>
<p>In contrast, the covariance matrix for the full
<code>ndvi_AK10000</code> data set would have <span class="math inline">\(10,000 \times 10,000 = 100,000,000\)</span>
elements which creates a computationally infeasible problem for a normal
computer.</p>
<p>For these reasons, <code>fitGLS_paritition</code> may be the most
useful function in the <code>remotePARTS</code> package. This function
can perform the GLS analysis on the full <code>ndvi_AK10000</code> data
set. In fact, <code>ndvi_AK10000</code> is quite small in comparison to
many remote sensing data sets that could be analyzed with
<code>fitGLS_partition()</code>.</p>
<div id="partitioned-gls" class="section level2">
<h2>Partitioned GLS</h2>
<p><code>fitGLS_parition()</code> conducts GLS analyses on partitions of
the data and then combines the results from the partitions to give
overall statistical results. Specifically, this process (1) breaks the
data into smaller and more manageable pieces (partitions), (2) conducts
GLS on each partition, (3) calculates cross-partition statistics from
pairs of partitions, and (4) summarizes the results with statistical
tests that account for correlations among partitions. We will use the
full <code>ndvi_AK10000</code> data set to demonstrate
<code>fitGLS_parition()</code>.</p>
<p>We have already performed the time-series analyses on the full data
set so you donât have to. These are in the <code>AR_coef</code> column
of <code>ndvi_AK10000</code>. However, we used a complete data set, so
you will need to remove rare land-cover classes.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> ndvi_AK10000</span></code></pre></div>
<p>Step (1) is to divide pixels up into partitions, which is done with
the function <code>sample_parition()</code>. Passing
<code>sample_partitions</code>, the number of pixels in our map, and the
argument <code>partsize = 1500</code> will result in a partition matrix
with 1,500 rows and 20 columns. Columns of the resulting partition
matrix <code>pm</code> each contain a random sample of 1,500 pixels.
Each of these 20 samples (partitions) are non-overlapping, containing no
repeats. Setting <code>npart = NA</code> will automatically give the
maximum number of partitions possible (i.e., 20).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pm <span class="ot">&lt;-</span> <span class="fu">sample_partitions</span>(<span class="at">npix =</span> <span class="fu">nrow</span>(df), <span class="at">partsize =</span> <span class="dv">1500</span>, <span class="at">npart =</span> <span class="cn">NA</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pm)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1500    6</span></span></code></pre></div>
<p>Once we have our partition matrix, <code>fitGLS_parititon()</code>
performs steps (2)-(4) of the analyses. The input is similar to
<code>fitGLS</code>. For this example, we specify (i) a formula, (ii)
the data as a data.frame (<code>df</code>), (iii) the partition matrix
(partmat <code>pm</code>), (iv) the covariance function
(<code>covar_FUN</code>), (v) a list of spatial parameters
<code>covar.pars</code> including our optimized range parameter, and a
<code>nugget</code>. If <code>nugget</code> is specified, this value is
used for the calculations, while if <code>nugget</code> =
<code>NA</code> (the default) it is estimated for each partition
separately.</p>
<p>Note that, although the compute time is much faster than if we needed
to invert the full covariance matrix <code>V</code>, this example still
takes a long time to fit. Therefore, we have saved the output of this
code as an R object <code>partGLS.ndviAK</code> so that you can look at
its output without having to execute the function.</p>
<p>The model was fit with this code:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>partGLS_ndviAK <span class="ot">&lt;-</span> <span class="fu">fitGLS_partition</span>(<span class="at">formula =</span> AR_coef <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> land, <span class="at">data =</span> df, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">partmat =</span> pm, <span class="at">covar_FUN =</span> <span class="st">&quot;covar_exp&quot;</span>, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">covar.pars =</span> <span class="fu">list</span>(<span class="at">range =</span> range.opt),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nugget =</span> nug.opt, <span class="at">ncores =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>and can be loaded with</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(partGLS_ndviAK)</span></code></pre></div>
<p>Here are the t-tests, that show that land cover class does not
significantly affect NDVI trend:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>partGLS_ndviAK<span class="sc">$</span>overall<span class="sc">$</span>t.test</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="do">## $p.t</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="do">##                        Est          SE    t.stat    pval.t</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="do">## landShrubland 0.0013094359 0.001899589 0.6893260 0.4906359</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="do">## landSavanna   0.0004379666 0.001902064 0.2302586 0.8178960</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="do">## landGrassland 0.0016210956 0.001894683 0.8556027 0.3922404</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="do">## $covar_coef</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="do">##              [,1]         [,2]         [,3]</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,] 3.623978e-06 3.569499e-06 3.561642e-06</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,] 3.566697e-06 3.633439e-06 3.537596e-06</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,] 3.562415e-06 3.540957e-06 3.605232e-06</span></span></code></pre></div>
<p>It is <strong>highly</strong> recommended that users read the full
documentation (<code>?fitGLS_parition()</code>) before using
<code>fitGLS_partition</code> to analyze any data.</p>
<!-- ##### Chisqr-test problem  -->
<p>Here is the p-value for the chisqr test of the partitioned GLS
<!-- it seems very wrong: --></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>partGLS_ndviAK<span class="sc">$</span>overall<span class="sc">$</span>pval.chisqr</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="do">## pval.chisqr </span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="do">##       1e-06 </span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="do">## attr(,&quot;rankdef.MSR&quot;)</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span></code></pre></div>
<p>This again, indicates that the model which includes land cover
classes better explains variation in NDVI trends than the intercept-only
model. Note that the p-value is much lower than the p-value from the
F-test conducted by <code>fitGLS()</code>. This is likely due to
outliers in the data, which should be removed before conducting any real
analysis. One simple way to filter potential trend outliers would be to
remove any pixels whose time-series coefficient standard errors are
unusually large (e.g., <code>SE &gt; 4*mean(SE)</code>).</p>
</div>
<div id="conclusions" class="section level2">
<h2>Conclusions</h2>
<p>Our parititoned GLS has returned the same conclusions as our standard
GLS analysis. No map-level trend in NDVI was found within any of the
land cover classes.</p>
<p>This was only one of our three hypotheses tested earlier. The
remaining two can easily be tested with <code>fitGLS_partition()</code>,
as they were with <code>fitGLS</code>, by changing the formula
argument.</p>
<!-- Here's a manual test: -->
<!-- ```{r} -->
<!-- (stats = with(partGLS_ndviAK$overall, c(Fmean = Fstat, rSSR = rSSR, dfs[1], partdims["npart"]))) -->
<!-- ## use function -->
<!-- remotePARTS:::part_chisqr(stats["Fmean"], stats["rSSR"], stats["df1"], stats["npart"]) -->
<!-- ## test manually -->
<!-- (rZ = (stats["rSSR"]/stats["df1"])^0.5) -->
<!-- (v.MSR = diag(stats["df1"]) - rZ) -->
<!-- V.MSR = kronecker(diag(stats["npart"]), v.MSR) + rZ -->
<!-- (lambda = eigen(V.MSR)$values) -->
<!-- (pval = CompQuadForm::imhof(q = stats["npart"] * stats["df1"] * stats["Fmean"], lambda = lambda)$Qq) -->
<!-- (pval.print = ifelse(pval < 1e-6, 1e-6, pval)) -->
<!-- ``` -->
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
